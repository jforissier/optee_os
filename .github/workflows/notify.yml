name: Maintainer notification
on:
  # Runs on pull requests with trusted code checked out from the target branch,
  # not the PR branch. On a standard pull_request event, the PR branch is
  # checked out but the GITHUB_TOKEN does not have write access to issues.
  pull_request_target:
    types: [opened, synchronize]
permissions:
  contents: read
  issues: write
jobs:
  notify_maintainers:
    name: Notify maintainers
    runs-on: ubuntu-latest
    if: github.repository == 'jforissier/optee_os'
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      - name: Install python3-github
        run: |
          sudo apt-get update
          sudo apt-get install python3-github
      - name: Run scripts/notify_maintainers.py
        env:
          PR_NUMBER: ${{ github.event.pull_request.number }}
          REPO: ${{ github.repository }}
        run: scripts/notify_maintainers.py
